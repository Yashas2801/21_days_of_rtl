# Directories
SRC_DIR = ../src
SIM_DIR = ../sim
VSIMOPT = -vopt -voptargs=+acc 

# Files
VERILOG_FILES = $(SRC_DIR)/d1_design.v $(SRC_DIR)/d1_test.v
TOP_MODULE = d1_test

# Simulation using QuestaSim
simulate:
	mkdir -p ../quartus
	mkdir -p $(SIM_DIR)
	vlib $(SIM_DIR)
	vlog -work $(SIM_DIR) $(VERILOG_FILES)
	vsim $(VSIMOPT) -c -do "log -r /* ;run -all; quit" $(TOP_MODULE) -work $(SIM_DIR) -l $(SIM_DIR)/simulation.log -wlf $(SIM_DIR)/waveform.wlf

simulate_gui:
	mkdir -p $(SIM_DIR)
	vlib $(SIM_DIR)
	vlog -work $(SIM_DIR) $(VERILOG_FILES)
	vsim $(VSIMOPT) -do "log -r /*" $(TOP_MODULE) -work $(SIM_DIR)

view_wave_Questa:
	vsim -view $(SIM_DIR)/waveform.wlf


help:
	@echo "=================================== HELP ===================================="
	@echo "Makefile Commands:"
	@echo ""
	@echo "  simulate          : Run the simulation using QuestaSim and save waveform/log."
	@echo "  view_wave_Questa  : View the waveform generated by QuestaSim."
	@echo "  simulate_gui      : Run the simulation in QuestaSim GUI mode for interactive debugging."
	@echo "  clean             : Remove all generated files and clean the workspace."
	@echo ""
	@echo "Example Usage:"
	@echo "  make simulate          # To run the simulation in QuestaSim."
	@echo "  make simulate_gui      # To run the simulation in QuestaSim GUI mode."
	@echo "  make view_wave_Questa  # To view the waveform from QuestaSim."
	@echo "  make clean             # To clean all generated files."
	@echo "============================================================================"

# Clean command
clean:
	rm -rf $(SIM_DIR)

